<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Product Image View</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="icon" type="image/png" href="/images/logo-removebg-preview.png" />
  <style>
    :root{
      --bg:#07121a;
      --card: rgba(255,255,255,0.03);
      --muted: #cbd5e1;
    }
    html,body{height:100%}
    body{
      margin:0;
      background: linear-gradient(180deg,var(--bg), #021021);
      color: #eef6ff;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      display:flex;
      align-items:flex-start;
      justify-content:center;
      padding:18px;
    }
    .wrap{ width:100%; max-width:1100px; }
    .card { background: var(--card); border: 1px solid rgba(255,255,255,0.04); border-radius: 10px; padding:14px; }
    .toolbar { display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; gap:12px; }
    .small-muted { color:var(--muted); font-size:0.92rem; }
    .img-wrap { display:flex; align-items:center; justify-content:center; min-height:64vh; }
    .img-wrap img { max-width:100%; max-height:80vh; border-radius:8px; box-shadow: 0 8px 30px rgba(2,6,23,0.7); }
    .notice { text-align:center; padding:56px 10px; color:var(--muted); }
    a.btn-back { text-decoration:none; color:#e6eef8; border:1px solid rgba(255,255,255,0.06); padding:6px 10px; border-radius:6px; background:transparent; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="toolbar">
        <a class="btn-back" href="dashboard.html">← Back to Store</a>
      </div>

      <div id="resultArea" class="img-wrap"></div>
    </div>
  </div>

  <script>
    function getQueryParam(name){
      return new URLSearchParams(window.location.search).get(name);
    }

    const resultArea = document.getElementById('resultArea');
    const url = getQueryParam('url');

    if (!url) {
      resultArea.innerHTML = '<div class="notice">No image specified.<br>Use <code>?url=&lt;IMAGE_URL&gt;</code></div>';
    } else {
      const proxy = '/product/view?url=' + encodeURIComponent(url);
      const img = document.createElement('img');
      img.src = proxy;
      img.alt = 'Product image (proxied)';
      img.onerror = function(){
        resultArea.innerHTML = '<div class="notice" style="color:#ffb4b4">Không thể tải ảnh.<br>Server có thể trả lỗi hoặc nội dung không phải là ảnh.</div>';
      };
      resultArea.appendChild(img);
    }
  </script>
</body>
</html>
